"use strict";(self.webpackChunkevil_pro_cli=self.webpackChunkevil_pro_cli||[]).push([[69],{86473:function(Fe,P,a){a.r(P),a.d(P,{default:function(){return je}});var Y=a(97857),x=a.n(Y),L=a(15009),m=a.n(L),O=a(99289),j=a.n(O),H=a(5574),I=a.n(H),Z={rowKey:"id",tableAlertRender:!1,search:!1,options:{reload:!0,density:!1,setting:!1},pagination:{defaultPageSize:10,showSizeChanger:!0,disabled:!1},scroll:{x:"max-content"},form:{syncToUrl:!0,syncToInitialValues:!1}},De="",Ze={required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"},J=a(11774),A=a(68832),z=a(32188),g=a(42075),Q=a(86250),W=a(3363),p=a(67294),k=a(82114),w=a(47756),n=a(85893),X=w.Z.Text,q=function(t){var e=t.onClick;return(0,n.jsxs)(g.Z,{onClick:e,children:[(0,n.jsx)(k.Z,{style:{color:"#f50"}}),(0,n.jsx)(X,{type:"secondary",style:{cursor:"pointer"},children:"\u5E73\u8861\u6821\u9A8C\u5F02\u5E38"})]})},_=q,ee=a(50675),te=a(8913),N=a(37476),ae=a(88280),ne=[{title:"\u516C\u5F0F\u63CF\u8FF0",dataIndex:"description"},{title:"\u662F\u5426\u901A\u8FC7",dataIndex:"passes",valueEnum:{true:{text:"\u901A\u8FC7"},false:{text:"\u4E0D\u901A\u8FC7"}},render:function(t,e){var r=e.passes;return r?(0,n.jsxs)(g.Z,{style:{color:"#87d068"},children:[(0,n.jsx)(ee.Z,{}),t]}):(0,n.jsxs)(g.Z,{style:{color:"#f50"},children:[(0,n.jsx)(te.Z,{}),t]})}}],re=[{title:"\u79D1\u76EE",dataIndex:"type",editable:!1},{title:"\u503C",dataIndex:"value1",valueType:"digit",fieldProps:{bordered:!1,width:"200"}}],ue=function(t){var e=(0,z.useModel)("EarningsComparison.model",function(i){return{updateRecord:i.updateRecord,updateRecords:i.updateRecords,exceptionData:i.exceptionData,periods:i.periods,data:i.data}}),r=e.data,f=e.exceptionData,u=e.periods,y=e.updateRecords,R=(0,p.useState)(function(){return r[u].map(function(i){return i.key})}),E=I()(R,2),S=E[0],b=E[1];(0,p.useEffect)(function(){var i=r[u].map(function(d){return d.key});b(i)},[u,r]);var F=(0,p.useMemo)(function(){var i=f[0].equation.keysToVerify;return r[u].filter(function(d){return i.includes(d.key)})},[f,r,u]),C=(0,p.useRef)();return(0,n.jsxs)(N.Y,x()(x()({title:"\u8868\u5185\u516C\u793A\u5E73\u8861\u6821\u9A8C",autoFocusFirstInput:!0},t),{},{onFinish:j()(m()().mark(function i(){return m()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return y(u,C.current),v.abrupt("return",!0);case 2:case"end":return v.stop()}},i)})),children:[(0,n.jsx)(A.Z,x()(x()({},Z),{},{rowKey:"key",search:!1,options:!1,pagination:!1,columns:ne,size:"small",className:"inner-table",dataSource:f})),(0,n.jsx)(ae.Z,{className:"inner-table",headerTitle:"\u516C\u5F0F\u63CF\u8FF0",size:"small",columns:re,rowKey:"key",controlled:!0,value:F,onChange:function(d){C.current=d},recordCreatorProps:!1,editable:{type:"multiple",editableKeys:S,actionRender:function(d,v,D){return[D.delete]},onChange:b}})]}))},se=ue,le=a(83062),ie=a(5867),oe=w.Z.Text,de=w.Z.Title,ce=function(t,e,r){var f=Number(t.replace("%","")),u=Number(e.replace("%","")),y=Number(r.replace("%",""));return u<=f&&f<=y},B=function(t,e){var r=ce(t,e.min,e.max);return r?t:(0,n.jsx)(le.Z,{title:"".concat(e.min,"-").concat(e.max),color:"green",placement:"right",children:(0,n.jsx)(de,{level:4,type:"danger",children:t})})},ve=[{title:"\u9879\u76EE",dataIndex:"type",width:100},{title:"\u540C\u82B1\u987A",dataIndex:"value1",width:100,render:function(t,e){return B(e.value1,e)}},{title:"\u4F01\u67E5\u67E5",dataIndex:"value2",width:100,render:function(t,e){return B(e.value2,e)}},{title:"\u5BA2\u6237\u63D0\u4F9B",dataIndex:"value3",width:100,render:function(t,e){return B(e.value3,e)}}],fe=function(){return(0,n.jsx)(N.Y,{title:"\u6307\u6807\u5206\u6790\u7ED3\u679C",trigger:(0,n.jsxs)(g.Z,{align:"start",children:[(0,n.jsx)(k.Z,{style:{color:"#f50"}}),(0,n.jsx)(oe,{type:"secondary",style:{cursor:"pointer"},children:"\u540C\u82B1\u987A\u548C\u5BA2\u6237\u63D0\u4F9B\u8D22\u62A5\u8BA1\u7B97 \u51FA\u6765\u7684\u8D22\u52A1\u6307\u6807\u504F\u79BB\u5EA6\u8FC7\u5927"})]}),autoFocusFirstInput:!0,submitter:!1,children:(0,n.jsx)(A.Z,x()(x()({},Z),{},{rowKey:"key",search:!1,options:!1,pagination:!1,columns:ve,size:"small",className:"inner-table",dataSource:ie.kU}))})},pe=fe,he=a(27484),xe=a.n(he),Ae=a(33852),me=function(){var l=j()(m()().mark(function t(){var e,r=arguments;return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return e=r.length>0&&r[0]!==void 0?r[0]:100,u.abrupt("return",new Promise(function(y){setTimeout(function(){y(!0)},e)}));case 2:case"end":return u.stop()}},t)}));return function(){return l.apply(this,arguments)}}(),ye=function(){var l=j()(m()().mark(function t(){var e,r=arguments;return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return e=r.length>0&&r[0]!==void 0?r[0]:100,u.next=3,me(e);case 3:case"end":return u.stop()}},t)}));return function(){return l.apply(this,arguments)}}();xe().locale("zh-cn");function Ce(l,t,e){return l!==t||l!==e||t!==e}var V="#87d068",K="#f50",ge=function(t){var e=Ce(t.value1,t.value2,t.value3),r={backgroundColor:"#f6ffed"};return e&&(r.backgroundColor="yellow"),r},$=["1","2","3"],Te=function(){var t=(0,p.useRef)(),e=(0,p.useState)("tab1"),r=I()(e,2),f=r[0],u=r[1],y=(0,p.useState)(!1),R=I()(y,2),E=R[0],S=R[1],b=(0,p.useState)($),F=I()(b,2),C=F[0],i=F[1],d=(0,z.useModel)("EarningsComparison.model",function(o){return{data:o.data,exceptionData:o.exceptionData,setPeriods:o.setPeriods,setExceptionType:o.setExceptionType,periods:o.periods}}),v=d.data,D=d.exceptionData,Ie=d.setPeriods,Re=d.setExceptionType,Ee=d.periods,Se=(0,p.useMemo)(function(){return D.some(function(o){return!o.passes})},[D,v,Ee]),be=[{title:"\u79D1\u76EE",dataIndex:"type",width:200,hideInSearch:!0},{dataIndex:"value1",title:(0,n.jsxs)(g.Z,{children:[Se&&(0,n.jsx)(_,{onClick:function(){Re("value1"),S(!0)}}),"\u540C\u82B1\u987A"]}),width:250,hideInSearch:!0,render:function(c,s){var h=s.value1===s.value2||s.value1===s.value3?V:K;return(0,n.jsx)("span",{style:{color:h},children:c})},hideInTable:!C.includes("1")},{title:"\u4F01\u67E5\u67E5",dataIndex:"value2",width:250,hideInSearch:!0,render:function(c,s){var h=s.value2===s.value1||s.value2===s.value3?V:K;return(0,n.jsx)("span",{style:{color:h},children:c})},hideInTable:!C.includes("2")},{title:"\u5BA2\u6237\u63D0\u4F9B",dataIndex:"value3",width:250,hideInSearch:!0,render:function(c,s){var h=s.value3===s.value1||s.value3===s.value2?V:K;return(0,n.jsx)("span",{style:{color:h},children:c})},hideInTable:!C.includes("3")},{title:"\u5BA2\u6237",dataIndex:"consumer",hideInTable:!0,valueEnum:{1:{text:"\u5BA2\u62371",status:"Default"},2:{text:"\u5BA2\u62372",status:"Default"},3:{text:"\u5BA2\u62373",status:"Default"}},initialValue:"1"},{title:"\u8D22\u62A5\u671F\u6570",dataIndex:"periods",hideInTable:!0,initialValue:"2024-03",valueType:"dateMonth"},{title:"\u8D22\u62A5\u7C7B\u578B",dataIndex:"financialType",hideInTable:!0,valueType:"radio",valueEnum:{1:{text:"\u5355\u4F53",status:"Default"},2:{text:"\u5408\u5E76",status:"Default"}},initialValue:"2"},{title:"\u6765\u6E90\u6E20\u9053",valueEnum:{1:{text:"\u540C\u82B1\u987A"},2:{text:"\u4F01\u67E5\u67E5"},3:{text:"\u5BA2\u6237\u63D0\u4F9B"}},valueType:"checkbox",dataIndex:"sourceChannel",hideInTable:!0,initialValue:$}];return(0,n.jsxs)(J._z,{header:{title:!1},children:[(0,n.jsx)(A.Z,x()(x()({},Z),{},{rowKey:"key",scroll:{x:"100%"},search:{filterType:"query",defaultCollapsed:!1,searchText:"\u8D22\u62A5\u5BF9\u6BD4",resetText:"\u6761\u4EF6\u91CD\u7F6E"},pagination:!1,actionRef:t,columns:be,toolbar:{menu:{type:"tab",activeKey:f,items:[{key:"tab1",label:"\u8D44\u4EA7\u8D1F\u503A\u8868"},{key:"tab2",label:"\u5229\u6DA6\u8868",disabled:!0},{key:"tab3",label:"\u73B0\u91D1\u6D41\u91CF\u8868",disabled:!0}],onChange:function(c){u(c)}}},onRow:function(c){return{style:ge(c)}},tableRender:function(c,s){return(0,n.jsxs)(Q.Z,{gap:"middle",children:[s,(0,n.jsx)("div",{style:{width:250},children:(0,n.jsx)(W.Z,{direction:"vertical",size:"small",current:1,items:[{title:"\u8D22\u62A5\u6BD4\u5BF9",description:"\u8D22\u52A1\u62A5\u8868\u79D1\u76EE\u9879\u6BD4\u5BF9"},{title:"\u6307\u6807\u5206\u6790\u7ED3\u679C",description:(0,n.jsx)(pe,{})}]})})]})},params:{update:v},request:function(){var o=j()(m()().mark(function c(s){var h,M,U,G;return m()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return h=s.periods,M=s.sourceChannel,U=M===void 0?[]:M,T.next=3,ye(1e3);case 3:return i(U),Ie(h),G=(v==null?void 0:v[h])||[],T.abrupt("return",{data:G,success:!0});case 7:case"end":return T.stop()}},c)}));return function(c){return o.apply(this,arguments)}}()})),(0,n.jsx)(se,{open:E,onOpenChange:S})]})},je=Te}}]);
