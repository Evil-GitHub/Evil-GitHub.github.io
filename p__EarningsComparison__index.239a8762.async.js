"use strict";(self.webpackChunkevil_pro_cli=self.webpackChunkevil_pro_cli||[]).push([[69],{83442:function(Ke,N,e){e.r(N),e.d(N,{default:function(){return Ae}});var L=e(97857),y=e.n(L),J=e(15009),b=e.n(J),Q=e(9783),W=e.n(Q),X=e(19632),q=e.n(X),_=e(99289),k=e.n(_),ee=e(5574),A=e.n(ee),te=e(96695),w=e.n(te),B={rowKey:"id",tableAlertRender:!1,search:!1,options:{reload:!0,density:!1,setting:!1},pagination:{defaultPageSize:10,showSizeChanger:!0,disabled:!1},scroll:{x:"max-content"}},Oe="",ze={required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"},ae=e(11774),M=e(68832),$=e(32188),j=e(42075),ne=e(86250),re=e(3363),p=e(67294),G=e(82114),V=e(47756),a=e(85893),le=V.Z.Text,se=function(n){var t=n.onClick;return(0,a.jsxs)(j.Z,{onClick:t,children:[(0,a.jsx)(G.Z,{style:{color:"#f50"}}),(0,a.jsx)(le,{type:"secondary",style:{cursor:"pointer"},children:"\u5E73\u8861\u6821\u9A8C\u5F02\u5E38"})]})},ue=se,ie=e(50675),oe=e(8913),H=e(37476),de=e(88280),ce=[{title:"\u516C\u5F0F\u63CF\u8FF0",dataIndex:"description"},{title:"\u662F\u5426\u901A\u8FC7",dataIndex:"passes",valueEnum:{true:{text:"\u901A\u8FC7"},false:{text:"\u4E0D\u901A\u8FC7"}},render:function(n,t){var r=t.passes;return r?(0,a.jsxs)(j.Z,{style:{color:"#87d068"},children:[(0,a.jsx)(ie.Z,{}),n]}):(0,a.jsxs)(j.Z,{style:{color:"#f50"},children:[(0,a.jsx)(oe.Z,{}),n]})}}],ve=[{title:"\u79D1\u76EE",dataIndex:"type",editable:!1},{title:"\u503C",dataIndex:"value1",valueType:"digit",fieldProps:{bordered:!1,width:"200"}}],fe=function(n){var t=(0,$.useModel)("EarningsComparison.model",function(l){return{updateRecord:l.updateRecord,updateRecords:l.updateRecords,exceptionData:l.exceptionData,periods:l.periods,data:l.data}}),r=t.data,c=t.exceptionData,s=t.periods,x=t.updateRecords,m=(0,p.useState)(function(){return r[s].map(function(l){return l.key})}),C=A()(m,2),h=C[0],g=C[1];(0,p.useEffect)(function(){var l=r[s].map(function(o){return o.key});g(l)},[s,r]);var I=(0,p.useMemo)(function(){var l=c[0].equation.keysToVerify;return r[s].filter(function(o){return l.includes(o.key)})},[c,r,s]),i=(0,p.useRef)();return(0,a.jsxs)(H.Y,y()(y()({title:"\u8868\u5185\u516C\u793A\u5E73\u8861\u6821\u9A8C",autoFocusFirstInput:!0},n),{},{onFinish:k()(b()().mark(function l(){return b()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return x(s,i.current),v.abrupt("return",!0);case 2:case"end":return v.stop()}},l)})),children:[(0,a.jsx)(M.Z,y()(y()({},B),{},{rowKey:"key",search:!1,options:!1,pagination:!1,columns:ce,size:"small",className:"inner-table",dataSource:c})),(0,a.jsx)(de.Z,{className:"inner-table",headerTitle:"\u516C\u5F0F\u63CF\u8FF0",size:"small",columns:ve,rowKey:"key",controlled:!0,value:I,onChange:function(o){i.current=o},recordCreatorProps:!1,editable:{type:"multiple",editableKeys:h,actionRender:function(o,v,Z){return[Z.delete]},onChange:g}})]}))},pe=fe,he=e(83062),ye=e(5867),xe=V.Z.Text,me=V.Z.Title,Ce=function(n,t,r){var c=Number(n.replace("%","")),s=Number(t.replace("%","")),x=Number(r.replace("%",""));return s<=c&&c<=x},K=function(n,t){var r=Ce(n,t.min,t.max);return r?n:(0,a.jsx)(he.Z,{title:"".concat(t.min,"-").concat(t.max),color:"green",placement:"right",children:(0,a.jsx)(me,{level:4,type:"danger",style:{display:"inline-block"},children:n})})},ge=[{title:"\u9879\u76EE",dataIndex:"type",width:100},{title:"\u540C\u82B1\u987A",dataIndex:"value1",width:100,render:function(n,t){return K(t.value1,t)}},{title:"\u4F01\u67E5\u67E5",dataIndex:"value2",width:100,render:function(n,t){return K(t.value2,t)}},{title:"\u5BA2\u6237\u63D0\u4F9B",dataIndex:"value3",width:100,render:function(n,t){return K(t.value3,t)}}],Ie=function(){return(0,a.jsx)(H.Y,{title:"\u6307\u6807\u5206\u6790\u7ED3\u679C",trigger:(0,a.jsxs)(j.Z,{align:"start",children:[(0,a.jsx)(G.Z,{style:{color:"#f50"}}),(0,a.jsx)(xe,{type:"secondary",style:{cursor:"pointer"},children:"\u540C\u82B1\u987A\u548C\u5BA2\u6237\u63D0\u4F9B\u8D22\u62A5\u8BA1\u7B97 \u51FA\u6765\u7684\u8D22\u52A1\u6307\u6807\u504F\u79BB\u5EA6\u8FC7\u5927"})]}),autoFocusFirstInput:!0,submitter:!1,children:(0,a.jsx)(M.Z,y()(y()({},B),{},{rowKey:"key",search:!1,options:!1,pagination:!1,columns:ge,size:"small",className:"inner-table",dataSource:ye.kU}))})},Re=Ie,Te=e(57540),je="#f6ffec",Se="#fff566",Ee=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(t.length<2)return{};var r=!0,c=new Set,s=w()(t),x;try{for(s.s();!(x=s.n()).done;){var m=x.value;if(n.hasOwnProperty(m)){var C=n[m];if(!c.has(C)){c.add(C);var h=w()(t.slice(t.indexOf(m)+1)),g;try{for(h.s();!(g=h.n()).done;){var I=g.value;if(n.hasOwnProperty(I)&&n[I]!==C){r=!1;break}}}catch(i){h.e(i)}finally{h.f()}if(!r)break}}}}catch(i){s.e(i)}finally{s.f()}return{backgroundColor:r?je:Se}},Fe=function(n,t){return t.map(function(r){return n.hasOwnProperty(r)?n[r]:null}).filter(function(r){return r!=null})},U=["value1"],be=function(){var n=(0,p.useRef)(),t=(0,p.useState)("tab1"),r=A()(t,2),c=r[0],s=r[1],x=(0,p.useState)(!1),m=A()(x,2),C=m[0],h=m[1],g=(0,p.useState)(U),I=A()(g,2),i=I[0],l=I[1],o=(0,$.useModel)("EarningsComparison.model",function(u){return{data:u.data,exceptionData:u.exceptionData,setPeriods:u.setPeriods,setExceptionType:u.setExceptionType,periods:u.periods}}),v=o.data,Z=o.exceptionData,Ze=o.setPeriods,De=o.setExceptionType,Pe=o.periods,Be=(0,p.useMemo)(function(){return Z.some(function(u){return!u.passes})},[Z,v,Pe]),O=function(f){return function(R,T){if(i.length<2)return R;var S=Fe(T,i.filter(function(P){return P!==f})),E=S.includes(T[f]),D=E?"#5b8c00":"#ff4d4f";return(0,a.jsx)("span",{style:{color:D},children:R})}},Me=[{title:"\u79D1\u76EE",dataIndex:"type",width:200,hideInSearch:!0},{dataIndex:"value1",title:(0,a.jsxs)(j.Z,{children:[Be&&(0,a.jsx)(ue,{onClick:function(){De("value1"),h(!0)}}),"\u540C\u82B1\u987A"]}),width:250,hideInSearch:!0,hideInTable:!i.includes("value1"),render:O("value1")},{title:"\u4F01\u67E5\u67E5",dataIndex:"value2",width:250,hideInSearch:!0,hideInTable:!i.includes("value2"),render:O("value2")},{title:"\u5BA2\u6237\u63D0\u4F9B",dataIndex:"value3",width:250,hideInSearch:!0,hideInTable:!i.includes("value3"),render:O("value3")},{title:"\u5BA2\u6237",dataIndex:"consumer",hideInTable:!0,valueEnum:{1:{text:"\u5BA2\u62371",status:"Default"}},initialValue:"1",fieldProps:{allowClear:!1}},{title:"\u8D22\u62A5\u671F\u6570",dataIndex:"periods",hideInTable:!0,initialValue:"2024-03",valueType:"dateMonth",fieldProps:{allowClear:!1}},{title:"\u8D22\u62A5\u7C7B\u578B",dataIndex:"financialType",hideInTable:!0,valueType:"radio",valueEnum:{1:{text:"\u5355\u4F53",status:"Default"},2:{text:"\u5408\u5E76",status:"Default"}},initialValue:"2"},{title:"\u6765\u6E90\u6E20\u9053",valueEnum:{value1:{text:"\u540C\u82B1\u987A"},value2:{text:"\u4F01\u67E5\u67E5"},value3:{text:"\u5BA2\u6237\u63D0\u4F9B"}},valueType:"checkbox",dataIndex:"sourceChannel",hideInTable:!0,initialValue:U}];return(0,a.jsxs)(ae._z,{header:{title:!1},children:[(0,a.jsx)(M.Z,y()(y()({},B),{},{rowKey:"key",scroll:{x:"100%"},search:{filterType:"query",defaultCollapsed:!1,searchText:"\u8D22\u62A5\u5BF9\u6BD4",resetText:"\u6761\u4EF6\u91CD\u7F6E"},pagination:!1,actionRef:n,columns:Me,toolbar:{menu:{type:"tab",activeKey:c,items:[{key:"tab1",label:"\u8D44\u4EA7\u8D1F\u503A\u8868"},{key:"tab2",label:"\u5229\u6DA6\u8868",disabled:!0},{key:"tab3",label:"\u73B0\u91D1\u6D41\u91CF\u8868",disabled:!0}],onChange:function(f){s(f)}}},onRow:function(f){return{style:Ee(f,i)}},tableRender:function(f,R){return(0,a.jsxs)(ne.Z,{gap:"middle",children:[R,(0,a.jsx)("div",{style:{width:250},children:(0,a.jsx)(re.Z,{direction:"vertical",size:"small",current:1,items:[{title:"\u8D22\u62A5\u6BD4\u5BF9",description:"\u8D22\u52A1\u62A5\u8868\u79D1\u76EE\u9879\u6BD4\u5BF9"},{title:"\u6307\u6807\u5206\u6790\u7ED3\u679C",description:(0,a.jsx)(Re,{})}]})})]})},params:{update:v},request:function(){var u=k()(b()().mark(function f(R){var T,S,E,D,P;return b()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return T=R.periods,S=R.sourceChannel,E=S===void 0?[]:S,F.next=3,(0,Te.p)(1e3);case 3:return l(E),Ze(T),D=(v==null?void 0:v[T])||[],P=D.map(function(z){var Ve={key:z.key,type:z.type};return Object.assign.apply(Object,[Ve].concat(q()(E.map(function(Y){return W()({},Y,z[Y])}))))}),F.abrupt("return",{data:P,success:!0});case 8:case"end":return F.stop()}},f)}));return function(f){return u.apply(this,arguments)}}()})),(0,a.jsx)(pe,{open:C,onOpenChange:h})]})},Ae=be}}]);
